---
title: HTTP概述
date: 2021-04-09 07:20:45
categories: HTTP
order: 1
tags:
  - JavaScript
  - http
---


## HTTP状态码

---

1. http 用来做什么

- `HTTP` 是一个在计算机世界里专门在「两点」之间「传输」文字、图片、音频、视频等「超文本」数据的「约定和规范」
- 它可以实现 `客户端-服务器` 或 `服务器-服务器` 的双向数据传输

2. 状态码

- `1xx`：提示信息，表示目前是协议处理的中间状态，还需要后续的操作
- `2xx`：成功，报文已被收到并被正确处理
- `3xx`：重定向，表示请求的资源位置发生了变动，需要客户端使用新的 `url` 重新发送请求获取资源
- `4xx`：客户端错误，表示客户端请求报文有误，服务器无法处理
- `5xx`：服务器错误，表示客户端请求报文正确，但是服务器在处理请求时内部发生了错误

3. 常见的状态码

- `200 OK`：最常见的成功状态码，表示一切正常。如果不是 `HEAD` 请求，服务器返回的响应数据都会有 `body` 数据
- `204 No Content`：也是常见的成功状态码，与 `200 OK` 基本相同，此次请求没有响应正文可发送，也就是响应头没有 `body` 数据
- `206 Partial Content`：应用于 `http` 分块下载或断点续传，表示响应返回的 `body` 数据并不是资源的全部，而是其中的一部分，也是服务器处理成功的状态
- `301 Moved Permanently`：表示永久重定向，说明请求的资源已经不存在了，需改换新的 `url` 再次访问。会在响应头里使用字段 `Location`，指明后续要跳转的 `URL`，浏览器会自动重定向新的 `URL`
- `302 Found`：表示临时重定向，说明请求的资源还在，但暂时需要用另一个 `url` 来访问。会在响应头里使用字段 `Location`，指明后续要跳转的 `URL`，浏览器会自动重定向新的 `URL`
- `304 Not Modified`：不具有跳转的含义，表示资源未修改，重定向已存在的缓存文件，也称缓存重定向，用于缓存控制
- `400 Bad Request`：表示客户端请求的报文有错误(例如，错误的请求语法、无效的请求消息帧或欺骗性的请求路由)，服务器不会或无法处理该请求
- `403 Forbidden`：表示服务器 **禁止访问资源**，客户端 **没有访问内容的权限**；也就是说，它是 **未经授权的**，因此服务器拒绝提供请求的资源，并不是客户端的请求出错
- `404 Not Found`：表示请求的资源在服务器上不存在或未找到，所以无法提供给客户端
- `500 Internal Server Error`：类似于 `400`，服务器遇到了不知道如何处理的情况，服务器发生了什么，我们并不知道
- `501 Not Implemented`：此请求方法不被服务器支持，因此无法被处理。只有 `GET` 和 `HEAD` 是要求服务器支持的，它们必定不会返回此错误代码
- `502 Bad Gateway`：通常是服务器作为网关或代理时返回的错误码，表示服务器自身工作正常，访问后端服务器发生了错误，得到了一个错误的响应
- `503 Service Unavailable`：表示服务器很忙，服务器没有准备好处理请求，所以无法响应，但应发送解释问题的用户友好界面。这个响应应该用于临时条件和如果可能的话，header  `Retry-After` 字段应该包含恢复服务之前的估计时间。另外，要注意与此响应一同发送的与缓存相关的其他 header，这些临时条件通常不应被缓存
- `504 Gateway Timeout`：当服务器 **充当网关** 且无法在规定的时间内获得响应时，会给出此回应

---

## HTTP 报文

---

1. http 版本下的区别

- `http/1.1` 以及之前的 `http` 协议报文都是 **语义可读** 的。在 `http/2` 中，这些报文被嵌入到了一个新的二进制结构，帧。帧允许实现很多优化，比如报文头部的压缩和复用。即使只有原始 HTTP 报文的一部分以 HTTP/2 发送出来，每条报文的语义依旧不变，客户端会重组原始 HTTP/1.1 请求。因此用 HTTP/1.1 格式来理解 HTTP/2 报文仍旧有效

2. 请求报文 

![MDN的一个hhtp请求](./img/HTTP_Request.png)

- ① 请求方法(Method)：用于定义客户端的动作行为。最常用的是 `GET` 获取资源 和 `POST` 提交资源到服务器，此外还包括 `DELETE`、`HEAD`、`OPTIONS`、`PUT`、`TRACE`
- ② 请求的 URL 地址(Path)，要获取的资源的路径，也就是请求的接口地址，它没有 `protocol` 和 `domain` 以及 `port`
- ③ HTTP 协议名称及版本号(Version of the protocol)
- ④ HTTP 的报文头(headers)，包含请求的书写，格式为 `属性名:属性值`，最大不超过 32K
- ⑤ HTTP 的报文体，用于传输请求参数、文件等，包含了发送的资源,最大不超过 2G

3. 响应报文 

![MDN的一个hhtp请求](./img/HTTP_Response.png)

- ① HTTP 协议名称及版本号(Version of the protocol)
- ② 一个状态码(status code)，来告知对应请求执行成功或失败，以及失败的原因
- ③ 一个状态信息(status message)，这个信息是非权威的状态码描述信息，可以由服务端自行设定
- ④ HTTP 的报文头(headers)，包含响应的书写，格式为 `属性名:属性值`，最大不超过 32K
- ⑤ HTTP 的报文体，包含了响应的资源 body

---

## HTTP Headers

---

1. 消息头

- HTTP 消息头允许客户端和服务器通过 `request`和 `response` 传递附加信息

2. 常见字段

- `Host`：客户端发送请求时，用来指定服务器的域名。我们可以通过 `Host` 字段将请求发往同一台「服务器」的不同网站
- `Content-Length`：服务器返回数据时，响应头里面会有 `Content-Length` 字段，表明此次回应的数据的长度
- `Connection`：该字段用于客户端要求服务器使用 TCP 持久连接，以便其他请求复用，直到客户端或服务器主动关闭连接。HTTP/1.1 版本的默认连接都是持久连接，但为了兼容老版本的 HTTP，需要指定 `Connection` 首部字段的值为 `Keep-Alive`
- `Content-Type`：用于服务器回应时，告诉客户端，本次数据实际返回的内容的内容类型

```
<!-- Content-Type:MIME type;charset -->
Content-Type: text/html; charset=utf-8
Content-Type: multipart/form-data; boundary=something
```

- `Accept`：用于客户端声明自己可以接受的数据的格式

```http
Accept: */*
<!-- 接受任何格式的数据 -->
```

- `Content-Encoding`：说明数据的压缩方法，表示服务器返回的数据使用了什么压缩格式

```
Content-Encoding: gzip
<!-- 服务器返回的数据采用了gzip格式压缩，客户端需使用此方式解压 -->
```

- `Accept-Encoding`：用于客户端发送请求时接受的压缩方法

```
Accept-Encoding: gzip, deflate
```

---

## HTTP Methods

---

1. 安全与幂等

- `安全`：在 HTTP 协议中，安全即是请求方法不会破坏服务器上的资源
- `幂等`：多次执行相同的操作或请求，结果都是相同的

2. GET

- 用于请求一个指定资源的表示形式，表示从服务器获取资源，这个资源可以是文本、图片、视频等

| -                    | -   |
| -------------------- | --- |
| 请求是否有主体       | 否  |
| 成功的响应是否有主体 | 是  |
| 安全                 | 是  |
| 幂等                 | 是  |
| 可缓存               | 是  |
| HTML 表单是否支持    | 是  |

3. HEAD

- 用于请求资源的头部信息, 并且这些头部与 HTTP GET 方法请求时返回的一致，但响应不应包含响应正文，即使包含了正文也必须忽略掉
- 如果响应头中可能包含了 `Content-Length`，但它们并不是用来描述 HEAD 响应本身的, 而是用来描述同样情况下的 GET 请求应该返回的响应
- 该请求方法的一个使用场景是在下载一个大文件前先获取其大小再决定是否要下载, 以此可以节约带宽资源

| -                    | -   |
| -------------------- | --- |
| 请求是否有主体       | 否  |
| 成功的响应是否有主体 | 否  |
| 安全                 | 是  |
| 幂等                 | 是  |
| 可缓存               | 是  |
| HTML 表单是否支持    | 否  |

4. POST

- 用于发送数据给服务器，请求主体的类型可以由 `Content-Type` 指定。一般可以指定以下几种类型

| 类型 | 描述 |
| --- | --- |
| application/x-www-form-urlencoded | 数据被编码成以 '&' 分隔的键-值对, 同时以 '=' 分隔键和值. 非字母或数字的字符会被 percent-encoding: 这也就是为什么这种类型不支持二进制数据(应使用 multipart/form-data 代替) |
| multipart/form-data |  |
| text/plain |  |

| -                    | -                                         |
| -------------------- | ----------------------------------------- |
| 请求是否有主体       | 是                                        |
| 成功的响应是否有主体 | 是                                        |
| 安全                 | 否                                        |
| 幂等                 | 否                                        |
| 可缓存               | Only if freshness information is included |
| HTML 表单是否支持    | 是                                        |

5. PUT

- 该方式会使用请求中的负载创建或者替换目标资源

| -                    | -   |
| -------------------- | --- |
| 请求是否有主体       | 是  |
| 成功的响应是否有主体 | 否  |
| 安全                 | 否  |
| 幂等                 | 是  |
| 可缓存               | 否  |
| HTML 表单是否支持    | 否  |

6. DELETE

- 用于删除指定的资源。如果成功执行，可能出现以下几种状态码

| 状态码         | 描述                                               |
| -------------- | -------------------------------------------------- |
| 202 Accepted   | 表示请求的操作可能会成功执行，但是尚未开始执行     |
| 204 No Content | 表示操作已执行，但是无进一步的相关信息             |
| 200 OK         | 表示操作已执行，并且响应中提供了相关状态的描述信息 |

| -                    | -      |
| -------------------- | ------ |
| 请求是否有主体       | 可以有 |
| 成功的响应是否有主体 | 可以有 |
| 安全                 | 否     |
| 幂等                 | 是     |
| 可缓存               | 否     |
| HTML 表单是否支持    | 否     |
